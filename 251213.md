# 251213

## 14:26

数据处理与加载

```python
import torch
from torch.utils.data import Dataset

class MyDataset(Dataset):
    def __init__(self, X_data, Y_data):
        self.X_data = X_data
        self.Y_data = Y_data
    def __len__(self):
        return len(self.X_data)
    def __getitem__(self, index):
        x = torch.tensor(self.X_data[index], dtype=torch.float)
        y = torch.tensor(self.Y_data[index], dtype=torch.float)
        return x, y

X_data = [[1, 2], [2, 3], [3, 4], [4, 5], [5, 6]]
Y_data = [[2], [3], [4], [5], [6]]
dataset = MyDataset(X_data, Y_data)
```

加载数据

```python
from torch.utils.data import DataLoader
dataloader = DataLoader(dataset, batch_size=2, shuffle=True)
for epoch in range(1):
    for batch_idx, (inputs, labels) in enumerate(dataloader):
        print(f'Batch: {batch_idx}, Inputs: {inputs}, Labels: {labels}')
```

预处理和数据增强
旋转、裁剪、归一化，torchvision.transforms

```python
import torchvision.transforms as transforms
from PIL import Image
transform = transforms.Compose([
    transforms.Resize((128, 128)),
    transforms.ToTensor(),
    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
])

image = Image.open('image.jpg')
image_tensor = transform(image)
print(image_tensor.shape)
```

图像数据增强：随机变换增加数据多样性

```python
transform = transforms.Compose(
    transforms.RandomHorizontalFlip(),  # 随机水平翻转
    transforms.RandomRotation(30),  # 随机旋转30度
    transforms.RandomCrop(224),  # 随机裁剪224*224
    transforms.ToTensor(),
    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
```

加载图像数据集

```python
import torchvision.datasets as datasets
import torchvision.transforms as transforms
transform = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize((0.5,), (0.5,))
])

train_dataset = datasets.MNIST(root='./data', train=True, download=True, transform=transform)
test_dataset = datasets.MNIST(root='./data', train=False, download=True, transform=transform)

train_loader = DataLoader(train_dataset, batch_size=64, shuffle=True)
test_loader = DataLoader(test_dataset, batch_size=64, shuffle=False)
for inputs, labels in train_loader:
    print(inputs.shape)
    print(labels.shape)
```

多个数据源

```python
from torch.utils.data import ConcatDataset
combined_dataset = ConcatDataset([dataset1, dataset2])
combined_loader = DataLoader(combined_dataset, batch_size=64, shuffle=True)
```
